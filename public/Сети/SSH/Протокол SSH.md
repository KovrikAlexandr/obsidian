## Определение
**SSH (Secure Shell)** - протокол безопасного удалённого доступа к другим машинам. Протокол находится на прикладном уровне [[Модель OSI|OSI]]. Использую SSH мы можем "войти" в терминал удалённого сервера и работать в нём, как на локальной машине.
## Как устроен
Есть пара ключей: приватный и публичный. Приватный ни в коем случае нельзя показывать. Публичный распространяется свободно. 

Чтобы авторизироваться под пользователем, на сервере в файле  `/home/user/.ssh/authorized_keys` должен лежать публичный ключ. Сама авторизация выглядит следующим образом:
1. Сначала устанавливается симметричное шифрование (например по Диффи-Хеллману)
2. Далее сервер присылает клиенту строку
3. Клиент "подписывает" её своим приватным ключом и возвращает серверу
4. Сервер проверяет подпись доступными публичными ключами из `authorized_keys`

Пара ключей связана тем, что приватный может подписать, а публичный проверить подлинность подписи.
## Генерируем ключ
Базово генерируем следующим образом:
```bash
ssh-keygen
```
Доступны следующие флаги:
- `-f "/path/to/key/file"` – путь до ключа + имя ключа
- `-t rsa` – используемый алгоритм шифрования. Доступны следующие: `rsa`, `ecdsa`, `ecdsa-sk`, `ed25519`, `ed25519-sk` и `rsa`. По умолчанию используется `ed25519`.
- `-C "some comment"` -комментарий к публичному ключу. Упрощает работу с кучей ключей на сервере
- `-N "some_password"` - пароль на приватный ключ. Можно не ставить, но с паролем безопаснее.

## Прокидываем ключ на сервер
Добавить можно руками или готовыми инструментами. Руками придётся ковырять права доступа к `authorized_keys`. По-человечески выглядит так:
```bash
ssh-copy-id -i ~/.ssh/keys/somekey.pub alex@host
```
- `ssh-copy-id` сам выполнит загрузку ключа на сервер и поменяет все права нужным образом
- `-i` – путь до публичного ключа на клиенте

После ввода команды потребуется ввести пароль пользователя.

## Заходим на сервер
Можем зайти либо по паролю (что не очень безопасно) или, используя ключ.
Вход по паролю:
```bash
ssh alex@host
```
- Попросит ввести пароль пользователя на сервере

Вход по ключу. Ничего больше вводить не надо:
```bash
ssh -i "~/.ssh/keys/somekey" alex@host
```
- `-i` - путь до **приватного** ключа на клиенте

## Дополнительные статьи
- [[SSH-конфиг на клиенте|Как настроить ssh-конфиг на клиенте?]]
- [[|Как работать с ssh-агентом?]]
- [[SSH туннели|Что такое ssh-туннель, зачем это нужно и как этим пользоваться?]]





